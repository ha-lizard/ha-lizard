.\" Manpage for ha-cfg
.TH HA-CFG 8 "December 2024" "__VERSION__" "HA-Lizard User Commands"
.SH NAME
ha-cfg \- HA-Lizard configuration utility
.SH SYNOPSIS
.B ha-cfg
[\fIaction\fR]
.SH DESCRIPTION
The \fIha-cfg\fR utility is used to manage HA-Lizard settings in a XenServer pool. It allows administrators to enable/disable HA, configure global parameters, manage virtual machines, and perform backup and restore operations.
.SH COMMANDS
.TP
.B backup
Creates a backup of the HA-Lizard configuration.

.TP
.B clear-alerts
Clears all HA-Lizard alert messages.

.TP
.B disk_monitor
Enables hourly disk health monitoring and triggers alerts for non-normal SMART flags.

.TP
.B email
Sends a test email alert.

.TP
.B email_debug
Provides verbose SMTP logs for debugging email alerts.

.TP
.B enable_alerts
Enables or disables pool-wide alerts.

.TP
.B enable_logging
Enables or disables logging for HA-Lizard.

.TP
.B fence_action
Supported actions: start, stop, reset.

.TP
.B fence_enabled
Enables or disables fencing.

.TP
.B fence_file_loc
Specifies the location for storing fencing scripts.

.TP
.B fence_ha_onfail
Determines whether to attempt starting VMs from a failed host on another host if fencing fails.

.TP
.B fence_ipaddress
Specifies the IP address for static fencing devices.

.TP
.B fence_method
Specifies the fencing method used (e.g., ILO, XVM).

.TP
.B fence_min_hosts
Defines the minimum number of hosts required before fencing can be performed.

.TP
.B fence_quorum_required
Specifies whether quorum is required from remaining hosts before fencing can occur.

.TP
.B fence_reboot_lone_host
Determines whether the Master host reboots before attempting to fence peers if no other pool members are available.

.TP
.B fence_slave
Specifies whether the slave host should attempt to start appliances or VMs if the Master is unreachable.

.TP
.B fence_use_ip_heuristics
Defines whether to use additional IPs to help determine quorum.

.TP
.B fence_heuristics_ips
Specifies a list of IPs or domain names to check for quorum determination.

.TP
.B fence_host_forget
Will be deprecated in future versions.

.TP
.B get
Lists all global parameters and their corresponding values.

.TP
.B get-vm-ha
Lists VMs within the pool and indicates whether HA is enabled for each VM.

.TP
.B ha-disable
Disables High Availability (HA) in the pool.

.TP
.B ha-enable
Enables High Availability (HA) in the pool.

.TP
.B ha-status
Displays the HA status as either "true" or "false".

.TP
.B log
Displays system logs generated by HA-Lizard for troubleshooting.

.TP
.B monitor_delay
Sets the delay in seconds between attempts to respawn HA-Lizard.

.TP
.B monitor_killall
Specifies whether to terminate all HA-Lizard processes if the threshold is exceeded.

.TP
.B monitor_max_starts
Defines the threshold for determining when running processes are unresponsive.

.TP
.B monitor_scanrate
Defines the time before reattempting to spawn HA-Lizard if there are active processes.

.TP
.B op_mode
Specifies the operating mode for HA-Lizard. 1 = manage appliances, 2 = manage virtual machines.

.TP
.B promote_slave
Specifies whether the slave should be promoted to pool master if the Master is unreachable.

.TP
.B remove
Erases all global parameters from the XAPI database. Use when manually removing HA from the pool.

.TP
.B restore
Restores a previously backed-up HA-Lizard configuration.

.TP
.B restore-default
Restores the default HA-Lizard configuration.

.TP
.B set
Modifies the value of a global parameter.

.TP
.B set-vm-ha
Enables or disables HA for the specified VM.

.TP
.B slave_vm_stat
Specifies whether slaves check the status of VMs and attempt to start them.

.TP
.B status
Shows whether HA is enabled or disabled for the pool.

.TP
.B show-alerts
Lists all HA-Lizard alert messages.

.TP
.B xapi_count
Defines the number of retry attempts for XAPI when a pool member cannot reach a peer.

.TP
.B xapi_delay
Sets the number of seconds to wait between XAPI retry attempts.

.TP
.B xe_timeout
Sets the maximum wait time for XE toolstack calls to respond.

.SH GLOBAL CONFIGURATION
Global configuration parameters are stored in the XAPI database, which is shared across all hosts in the pool.
.TP
.B disabled_vapps
Defines the UUID(s) of virtual appliances that should not be automatically started by HA-Lizard.

.TP
.B enable_alerts
Enables or disables alerts for HA-Lizard.

.TP
.B enable_logging
Enables or disables logging for HA-Lizard.

.TP
.B global_vm_ha
Specifies whether to enable HA for each VM individually when OP_MODE = 2.

.TP
.B monitor_max_starts
Defines the threshold for determining when running processes are unresponsive.

.TP
.B monitor_killall
Specifies whether to terminate all HA-Lizard processes if the threshold is exceeded.

.TP
.B monitor_delay
Sets the delay in seconds between attempts to respawn HA-Lizard.

.TP
.B monitor_scanrate
Defines the time before reattempting to spawn HA-Lizard if there are active processes.

.TP
.B op_mode
Specifies the operating mode for HA-Lizard. 1 = manage appliances, 2 = manage virtual machines.

.TP
.B xc_field_name
Specifies the field name used to enable or disable HA for the pool.

.TP
.B slave_vm_stat
Specifies whether slaves check the status of VMs and attempt to start them.

.TP
.B fence_enabled
Enables or disables fencing.

.TP
.B fence_file_loc
Specifies the location for storing fencing scripts.

.TP
.B fence_ha_onfail
Determines whether to attempt starting VMs from a failed host on another host if fencing fails.

.TP
.B fence_method
Specifies the fencing method used (e.g., ILO, XVM).

.TP
.B fence_passwd
Password for the fencing device (if required).

.TP
.B fence_action
Supported actions: start, stop, reset.

.TP
.B fence_reboot_lone_host
Determines whether the Master host reboots before attempting to fence peers if no other pool members are available.

.TP
.B fence_ipaddress
Specifies the IP address for static fencing devices.

.TP
.B fence_host_forget
Will be deprecated in future versions.

.TP
.B fence_min_hosts
Defines the minimum number of hosts required before fencing can be performed.

.TP
.B fence_quorum_required
Specifies whether quorum is required from remaining hosts before fencing can occur.

.TP
.B fence_use_ip_heuristics
Defines whether to use additional IPs to help determine quorum.

.TP
.B fence_heuristics_ips
Specifies a list of IPs or domain names to check for quorum determination.

.TP
.B mgt_link_loss_tolerance
Defines the number of seconds before VMs are forcibly shut down on a Master host that loses its management link.

.TP
.B disk_monitor
Enables hourly disk health monitoring and triggers alerts for non-normal SMART flags.

.SH AUTHOR
Written by Salvatore Costantino, <ha@ixi0.com>

.SH LICENSE
This program is free software; you can redistribute it and/or modify it under the terms
of the GNU General Public License as published by the Free Software Foundation; either
version 3 of the License, or (at your option) any later version.

.SH SEE ALSO
.Xref _ha-lizard(8)
